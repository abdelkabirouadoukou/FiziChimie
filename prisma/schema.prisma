generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Lesson {
  id          String   @id @default(cuid())
  title       String
  description String?  @db.Text
  
  // Educational Organization
  level       String   // e.g., "Collège", "Lycée", "Tronc Commun"
  year        String   // e.g., "1ère Année", "2ème Année", "1ère Bac", "2ème Bac"
  subject     String   // e.g., "Physique", "Chimie"
  chapter     String?  // e.g., "Mécanique", "Électricité", "Réactions Chimiques"
  lessonType  String   @default("Cours") // "Cours", "Exercice", "Examen", "Vidéo"
  
  // Sorting
  order       Int      @default(0) // For custom ordering within chapter
  
  // Content types
  pdfUrl      String?  // URL to PDF file
  videoUrl    String?  // YouTube URL or direct video URL
  links       Link[]
  
  // Metadata
  createdBy   String   // Clerk user ID
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  published   Boolean  @default(false)
  
  @@index([level])
  @@index([year])
  @@index([subject])
  @@index([chapter])
  @@index([published])
  @@index([lessonType])
}

model Link {
  id          String   @id @default(cuid())
  title       String
  url         String
  lessonId    String
  lesson      Lesson   @relation(fields: [lessonId], references: [id], onDelete: Cascade)
  createdAt   DateTime @default(now())
  
  @@index([lessonId])
}
